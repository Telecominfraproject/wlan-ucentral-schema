description: |
  This section configures Quality of Service (QoS) traffic classification and bandwidth shaping.
  QoS allows prioritization of network traffic to ensure better performance for critical applications
  like VoIP, video streaming, and gaming over bulk data transfers.
type: object
properties:
  select-ports:
    description:
      The physical network devices that shall be considered the primary uplink interface.
      All classification and shaping will happen on this device.
    type: array
    items:
      type: string
      default: WAN
  bandwidth-up:
    description: |
      Specifies the maximum upload bandwidth in megabits per second (Mbps) for traffic shaping.
      Set to 0 to disable upload bandwidth limiting or when the actual bandwidth is unknown.
      This is used by the QoS engine to properly shape outbound traffic flows.
      Example: Set to 100 for a 100 Mbps upload connection.
    type: integer
    default: 0
  bandwidth-down:
    description: |
      Specifies the maximum download bandwidth in megabits per second (Mbps) for traffic shaping.
      Set to 0 to disable download bandwidth limiting or when the actual bandwidth is unknown.
      This is used by the QoS engine to properly shape inbound traffic flows.
      Example: Set to 500 for a 500 Mbps download connection.
    type: integer
    default: 0
  bulk-detection:
    description:
      The QoS feature can automatically detect and classify bulk flows. This is based on average
      packet size and PPS.
    type: object
    properties:
      dscp:
        description:
          The differentiated services code point that shall be assigned to packets that belong
          to a bulk flow.
        $ref: 'https://ucentral.io/schema/v1/service/quality-of-service/class-selector/'
        default: CS0
      packets-per-second:
        description:
          The required PPS rate that will cause a flow to be classified as bulk.
        type: number
        default: 0
  services:
    description: |
      A list of predefined service names for automatic traffic classification.
      Services are defined in the community QoS database and include popular applications
      like 'zoom', 'netflix', 'gaming', 'voip', etc. Use 'all' to enable all available services.
      Each service automatically configures appropriate DSCP marking and port/domain matching rules.
      Example: ["zoom", "netflix", "voip"] enables QoS for these specific applications.
    type: array
    items:
      type: string
  classifier:
    description:
      A list of classifiers. Each classifier will map certain traffic to specific ToS/DSCP
      values based upon the defined constraints.
    type: array
    items:
      type: object
      properties:
        dscp:
          description: |
            The Differentiated Services Code Point (DSCP) marking to apply to matching packets.
            DSCP values control traffic prioritization in the network. Common values include:
            - EF (Expedited Forwarding) for real-time traffic like VoIP
            - AF41-AF43 for video streaming
            - CS0 for best-effort traffic
            - CS1 for bulk/background traffic
          $ref: 'https://ucentral.io/schema/v1/service/quality-of-service/class-selector/'
          default: CS1
        ports:
          description:
            Each entry defines a layer3 protocol and a port(range) that will be used to match packets.
          type: array
          items:
            type: object
            properties:
              protocol:
                description:
                  The port match can apply for TCP, UDP or any IP protocol.
                type: string
                enum:
                - any
                - tcp
                - udp
                default: any
              port:
                description: |
                  The TCP/UDP port number to match for traffic classification.
                  Can be combined with range-end to specify a port range.
                  Example: 80 for HTTP, 443 for HTTPS, 5060 for SIP.
                type: integer
              range-end:
                description: |
                  The ending port number when defining a port range for classification.
                  Used together with 'port' to specify a range like 'port: 5060, range-end: 5070'.
                  Leave unset when matching a single port number.
                type: integer
              reclassify:
                description: |
                  Controls whether to override existing DSCP markings on matching packets.
                  When true (default), applies the new DSCP marking regardless of existing values.
                  When false, only marks packets that don't already have DSCP markings.
                  Set to false to preserve upstream QoS markings.
                type: boolean
                default: true
        dns:
          description:
            Each entry defines a wildcard FQDN. The IP that this resolves to will be used to match packets.
          type: array
          items:
            type: object
            properties:
              fqdn:
                description: |
                  The fully qualified domain name to match for traffic classification.
                  Can be an exact domain or used with suffix-matching for wildcard behavior.
                  Example: 'netflix.com' or 'zoom.us' for application-specific classification.
                type: string
                format: uc-fqdn
              suffix-matching:
                description: |
                  Controls whether to match subdomains of the specified FQDN.
                  When true (default), matches all subdomains like '*.example.com'.
                  When false, matches only the exact domain specified.
                  Example: true matches both 'api.zoom.us' and 'web.zoom.us' for FQDN 'zoom.us'.
                type: boolean
                default: true
              reclassify:
                description: |
                  Controls whether to override existing DSCP markings on matching packets.
                  When true (default), applies the new DSCP marking regardless of existing values.
                  When false, only marks packets that don't already have DSCP markings.
                  Set to false to preserve upstream QoS markings.
                type: boolean
                default: true

